var ICON;var COUNT=5;var SKIP=0;var TOTAL=0;var currentPage;var totalPage;var isContinueLoad=true;function init(){if(tek.common.isLoggedIn()){readUser(myId);
getProfileInfo(myId,"profile_info");getFriendList("friend_owner");getFriendList("friend_other");getSubjectList(4,"subject_notice");getSubjectList(1,"subject_question");
}}function getProfileInfo(e,c){var b={operateType:"读取用户扩展信息"};var a={objectName:"Profile",action:"getList",profile_owner:e};var d={beforeSend:function(){var f="<div class='center'><img src='"+tek.common.getRootPath()+"http/images/waiting-small.gif'/>正在获取数据...</div>";
$("#"+c).html(f);},success:function(g){var f=g.record;if(f){$("#"+c).html("");f=!!f.length?f[0]:f;if(c=="profile_info"){showProfileInfo(f);}else{if(c=="friend_owner"){showFriendList(f,"friend_owner");
}else{if(c=="friend_other"){showFriendList(f,"friend_other");}}}}else{$("#"+c).text("没有用户信息！");}},error:function(g,f){$("#"+c).html(f);}};tek.common.ajax(tek.common.getRootPath()+"servlet/tobject",b,a,d);
}function showProfileInfo(a){if(!a){return;}var b="";var c;if(ICON){b+='<a href="'+tek.common.getRootPath()+"http/ican/person/read.html?profile_id="+a.id+'&show-close=1&refresh-opener=1" target="_blank"><img id="user_icon" src="'+ICON+'" alt="" class="img-respoonsive" /></a>';
}b+='<div class="ui-content">';if(a.name){b+="<h3>"+a.name;}b+="</h3>";if(a.profile_motto){c=a.profile_motto;b+="<p>"+tek.dataUtility.stringToHTML(c.value||"")+"</p>";
}b+='<ul class="ul-circle">';if(a.profile_jobarea){c=a.profile_jobarea;b+="<li>"+tek.dataUtility.stringToHTML(c.show||"")+"</li>";}if(a.profile_degree){c=a.profile_degree;
b+="<li>"+tek.dataUtility.stringToHTML(c.show||"")+"</li>";}if(a.profile_mode){c=a.profile_mode;b+="<li>"+tek.dataUtility.stringToHTML(c.show||"")+"</li>";
}b+="</ul>";b+='<div class="ui-social"><a href="#"><img src="../../images/social/readbook.png" class="img-thumbnail"></a><a href="#"><img src="../../images/social/weibo.png" class="img-thumbnail"></a><a href="#"><img src="../../images/social/huaban.png" class="img-thumbnail"></a><a href="#"><img src="../../images/social/qq-512.png" class="img-thumbnail"></a></div>';
$("#profile_info").html(b);}function getFriendList(c){var d=document.getElementById(c);if(!d){return;}var b={async:false,operateType:"获取关注好友列表"};var a={objectName:"Friend",action:"getList",count:COUNT,skip:SKIP,order:"createTime",desc:1,};
a[c]=myId;var e={beforeSend:function(){$("#"+c).html("<div class='col-md-12 col-sm-12'><img src='"+tek.common.getRootPath()+"http/images/waiting-small.gif' /></div>");
},success:function(j){var f=j.record;if(f){$("#"+c).html("");f=!f.length?[f]:f;if(c=="friend_owner"){RECORDS=f;for(var g in f){if(f[g].friend_other){getProfileInfo(f[g].friend_other.value,"friend_owner");
}}}else{if(c=="friend_other"){for(var g in f){if(f[g].friend_owner){getProfileInfo(f[g].friend_owner.value,"friend_other");}}}}var h=parseInt(j.value);
if(!h){h=0;}currentPage=tek.turnPage.getCurrentPageNumber(SKIP,COUNT);totalPage=tek.turnPage.getTotalPageNumber(TOTAL,COUNT);if(currentPage<totalPage){isContinueLoad=true;
}else{isContinueLoad=false;}}else{$("#"+c).html("<div class='col-md-12 col-sm-12 center'>没有动态信息！</div>");}},error:function(g,f){$("#"+c).html(f);}};tek.common.ajax(tek.common.getRootPath()+"servlet/tobject",b,a,e);
}function showFriendList(a,h){if(!a){return;}var d="";var g;var b=new Array("profile_name","profile_sex","profile_resident","profile_motto","profile_mode");
if(a.profile_owner){readUser(a.profile_owner.value);}if(ICON){d+='<img src="'+ICON+'" alt="" class="img-responsive">';}d+='<div class="ui-details"><div class="container-fluid"><div class="row">';
for(var c in b){var e=b[c];if(!e){break;}if(a[e]){g=a[e];d+='<div class="col-md-4 col-sm-4 col-xs-4 col-mob col-pad">';d+='<div class="ui-item">';d+="<h4>"+(g.display||"")+"</h4>";
d+="<h5>"+tek.dataUtility.stringToHTML(g.show||"")+"</h5>";d+="</div>";d+="</div>";}}d+="</div></div></div></div>";var f=document.getElementById(h);if(f){f.insertAdjacentHTML("BeforeEnd",d);
}}function readUser(b){var c={async:false,operateType:"读取用户信息"};var a={objectName:"User",action:"readInfo",user_id:b,icon:1};var d={beforeSend:function(){var e="<div class='center'><img src='"+tek.common.getRootPath()+"http/images/waiting-small.gif'/>正在获取数据...</div>";
$("#user_basic_info").html(e);},success:function(f){var e=f.record;if(e){e=!!e.length?e[0]:e;if(e.icon){ICON=e.icon;}else{ICON="images/1.jpg";}}},error:function(f,e){}};
tek.common.ajax(tek.common.getRootPath()+"servlet/tobject",c,a,d);}function getSubjectList(b,d){var c=tek.common.getRootPath()+"servlet/tobject";var a={operateType:"获取主题信息"};
var e={};e.objectName="Subject";e.action="getList";e.skip=0;e.order="createTime";e.desc=1;e.count=5;e.subject_type=b;var f={beforeSend:function(){$("#target").append("<div id='waiting-img' class='col-md-12 text-center col-sm-12'><img src='"+tek.common.getRootPath()+"http/images/waiting-small.gif' />正在加载数据...</div>");
},success:function(j){if(j.code==0){var g=j.record;if(g){$("#waiting-img").remove();g=!g.length?[g]:g;for(var h in g){showSubjectInfo(g[h],d);}}else{$("#target").html("<div class='col-md-12 col-sm-12 center'>没有主题信息！</div>");
}}},error:function(h,g){$("#target").html(g);}};tek.common.ajax(tek.common.getRootPath()+"servlet/tobject",a,e,f);}function showSubjectInfo(a,d){if(!a){return;
}var b="";var c;b+='<div class="item">';if(d=="subject_notice"){b+='<h3><a href="'+tek.common.getRootPath()+"http/takall/subject/read-notice.html?subject_id="+a.id+'" target="_blank">'+a.name+"</a></h3>";
}else{if(d=="subject_question"){b+='<h3><a href="'+tek.common.getRootPath()+"http/takall/subject/read-qa.html?subject_id="+a.id+'" target="_blank">'+a.name+"</a></h3>";
}}b+='<div class="meta">';if(a.createTime){c=a.createTime.show||"";b+='<i class="fa fa-calendar"></i>'+tek.dataUtility.stringToHTML(c)+"&nbsp;&nbsp;";}if(a.subject_owner){c=a.subject_owner.show||"";
b+='<i class="fa fa-user"></i></i>'+tek.dataUtility.stringToHTML(c);}if(a.subject_summary){c=a.subject_summary.show||"";b+="<p>"+tek.dataUtility.stringToHTML(c)+"</p>";
}b+="</div>";var d=document.getElementById(d);if(d){d.insertAdjacentHTML("BeforeEnd",b);}}