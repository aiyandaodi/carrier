var EVERY_ROW_SHOW=9;var PAGE_COUNT=9;var currentPage;var totalPage;var COUNT=PAGE_COUNT;var mydata={};var isContinueLoad=true;function init(){getLibrary();
}function getLibrary(){var a=document.getElementById("library-list");if(!a){return;}var b={};b.objectName="ExamsLibrary";b.action="getList";b.count=COUNT;
b.order="createTime";b.desc=1;if(request.group_id&&request.group_id!=null){b.exams_library_group=request.group_id;}$.ajax({async:true,type:"post",url:tek.common.getRootPath()+"servlet/tobject",dataType:"json",data:b,beforeSend:function(){$("#library-list").append("<div id='waiting-img' class='col-md-12 col-sm-12 center'><img style='margin-top:10px;' src='"+tek.common.getRootPath()+"http/images/waiting-small.gif' /></div>");
},success:function(e){$("#waiting-img").remove();if(e){if(tek.right.isCanCreate(e.right)){$("#library-button").removeClass("hidden");}if(e.code==0){var c=e.record;
if(c){if(c.length){for(var d in c){showLibraryList(c[d],a);}}else{showLibraryList(c,a);}}showCustomListTurn(e);}else{$("#library-list").html("<span class='text-muted center'>"+e.code+"-"+e.message+"</span>");
}}else{$("#library-list").html("<span class='text-muted center'>操作失败![data=null]</span>");}},error:function(){var c="操作失败!["+request.status+" - "+(request.response||request.statusText)+"]";
$("#library-list").html("<span class='text-muted center'>"+c.toString()+"</span>");}});}function showLibraryList(a,d){if(a&&d){var c;var b="";b+="<div class='col-md-6 col-sm-12 col-xs-12 col-mob'>";
b+="<div class='ui-item'>";b+="<div class='ui-last'></div>";b+="<div class='ui-middle'></div>";b+="<div class='ui-first'></div>";b+="<div class='ui-top'>";
b+="<h3>";b+="<a href='javascript:;'  onclick='readLibrary(\"";if(a.id){b+=a.id;}b+="\");'>";if(a.name){b+=a.name;}b+="</a>";b+="</h3>";b+="</div>";b+="<div class='ui-hover'>";
b+="<div class='ui-hcontent'>";b+="<ul class='ul-circle'>";b+="<li>";if(a.exams_library_grade){c=a.exams_library_grade;b+=c.display;b+="：";b+=tek.dataUtility.stringToHTML(c.show||"");
}b+="</li>";b+="<li>";if(a.exams_library_group){c=a.exams_library_group;b+=c.display;b+="：";b+=tek.dataUtility.stringToHTML(c.show||"");}else{b+="系统题库";
}b+="</li>";b+="<li>";if(a.exams_library_end){c=a.exams_library_end;b+=c.display;b+="：";b+=tek.dataUtility.stringToHTML(c.show||"");}b+="</li>";b+="</ul>";
b+="</div>";b+="</div>";b+="</div>";b+="</div>";if(d){d.insertAdjacentHTML("BeforeEnd",b);}}}function showLibraryList1(a,c){if(a&&c){var b;var e=new StringBuffer();
e.append("<div class='col-md-4 container-fluid'>");e.append("<div class='ui-item'>");e.append("<div class='ui-content'>");e.append("<h3>");e.append("<a href='#'  onclick='readLibrary(\"");
if(a.id){e.append(a.id);}e.append("\");'>");if(a.name){e.append(a.name);}e.append("</a>");e.append("<span class='pull-right library-item library-owner'><i class='fa fa-user'></i> ");
b=a.exams_library_owner;if(b&&b.show){e.append(b.show);}e.append("</span>");e.append("</h3>");e.append("<div class='row'>");e.append("<div class='col-md-12 col-sm-12'>");
e.append("<span class='library-item'>难度");b=a.exams_library_grade;if(b&&b.show){e.append(b.display);e.append("<span class='red'>");e.append(b.show);e.append("级</span>");
}e.append("</span>");e.append("</div>");e.append("<div class='col-md-12 col-sm-12'>");e.append("<span class='library-item'>");b=a.exams_library_group;if(b&&b.show){e.append(b.display);
e.append("<span class='red' title='");e.append(b.show);e.append("'>");e.append("<a href='javascript:;' onclick='readGroup(\"");e.append(b.value);e.append("\")'>");
var d=b.show||"";if(d&&d.length>17){e.append(d.substring(0,14)+"...");}else{e.append(d);}e.append("</a></span>");}else{e.append("<span class='red' title='");
e.append("' style='margin-left: 0px;'>");e.append("系统题库");e.append("</span>");}e.append("</span>");e.append("</div>");e.append("<div class='col-md-12 col-sm-12'>");
e.append("<sapn class='library-item'>");b=a.exams_library_end;if(b&&b.show){e.append(b.display);e.append("<span class='red'>");e.append(b.show);e.append("</span>");
}e.append("</span>");e.append("</div>");e.append("</div>");e.append("</div>");e.append("</div>");e.append("</div>");if(c){c.insertAdjacentHTML("BeforeEnd",e.toString());
}}}function readGroup(b){var a=tek.common.getRootPath()+"http/takall/group/read.html?group_id="+b;window.open(a,"_blank");}function readLibrary(b){if(!b){return;
}var a=tek.common.getRootPath()+"http/ican/library/read.html?exams_library_id="+b+"&show-close=1&refresh-opener=1";window.open(a,"_blank");}function addLibrary(){var a=tek.common.getRootPath()+"http/ipassin/library/add.html?show-close=1&refresh-opener=1&refresh-opener-func=refreshSubject";
if(request.group_id&&request.group_id!=null){a=a+"&group_id="+group_id;}window.open(a,"_blank");}function showCustomListTurn(d){var c=document.getElementById("page");
if(!c){return;}c.innerHTML="";var b=mydata.skip;if(!b){b=0;mydata.skip=b;}b=parseInt(b);if(!b){b=0;}COUNT=mydata.count;if(!COUNT){COUNT=PAGE_COUNT;mydata.count=COUNT;
}COUNT=parseInt(COUNT);if(!COUNT){COUNT=0;}var a=parseInt(d.value);if(!a){a=0;}c.innerHTML=tek.turnPage.getPagination(b,count,a);currentPage=tek.turnPage.getCurrentPageNumber(b,count);
totalPage=tek.turnPage.getTotalPageNumber(a,count);if(currentPage<totalPage){isContinueLoad=true;$("#more_page").removeClass("hidden");$("#ajax-load-div").addClass("hidden");
}else{isContinueLoad=false;$("#more_page").addClass("hidden");$("#ajax-load-div").addClass("hidden");}}$(window).scroll(function(){if(!isContinueLoad){return;
}if(($(this).scrollTop()+2)>=($(document).height()-$(this).height())){isContinueLoad=false;$("#more_page").addClass("hidden");changePage(null,(currentPage*COUNT));
}});function morePage(){if(currentPage<totalPage){if(!$("#library-list").is(":visible")){$(".wminimize").click();}isContinueLoad=false;$("#more_page").addClass("hidden");
changePage(null,(currentPage*COUNT));}else{$("#ajax-load-div").removeClass("hidden");$("#more_page").addClass("hidden");}}function changePage(b,a){mydata.skip=a;
getLibrary(a);}